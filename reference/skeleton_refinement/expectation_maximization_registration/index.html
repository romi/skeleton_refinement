
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Skeleton refinement documentation.">
      
      
        <meta name="author" content="ROMI Team">
      
      
        <link rel="canonical" href="https://romi.github.io/skeleton_refinement/reference/skeleton_refinement/expectation_maximization_registration/">
      
      
        <link rel="prev" href="../deformable_registration/">
      
      
        <link rel="next" href="../io/">
      
      
      <link rel="icon" href="../../../assets/images/ROMI_ICON_green.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>expectation_maximization_registration - Skeleton refinement</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.4af4bdda.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Nunito Sans";--md-code-font:"Ubuntu Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_markdown_exec_pyodide.css">
    
      <link rel="stylesheet" href="../../../assets/_markdown_exec_ansi.css">
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../assets/css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#skeleton_refinement.expectation_maximization_registration" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://romi.github.io/skeleton_refinement/" title="Skeleton refinement" class="md-header__button md-logo" aria-label="Skeleton refinement" data-md-component="logo">
      
  <img src="../../../assets/images/ROMI_logo_white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Skeleton refinement
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              expectation_maximization_registration
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/romi/skeleton_refinement" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  Reference API

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../dev/" class="md-tabs__link">
        
  
    
  
  Developers &amp; contributors

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://romi.github.io/skeleton_refinement/" title="Skeleton refinement" class="md-nav__button md-logo" aria-label="Skeleton refinement" data-md-component="logo">
      
  <img src="../../../assets/images/ROMI_logo_white.svg" alt="logo">

    </a>
    Skeleton refinement
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/romi/skeleton_refinement" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Reference API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Reference API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    skeleton_refinement
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            skeleton_refinement
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../cli/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    cli
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_1" id="__nav_2_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            cli
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/refine_skeleton/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    refine_skeleton
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deformable_registration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    deformable_registration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    expectation_maximization_registration
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    expectation_maximization_registration
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skeleton_refinement.expectation_maximization_registration" class="md-nav__link">
    <span class="md-ellipsis">
      expectation_maximization_registration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration" class="md-nav__link">
    <span class="md-ellipsis">
      ExpectationMaximizationRegistration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ExpectationMaximizationRegistration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.expectation" class="md-nav__link">
    <span class="md-ellipsis">
      expectation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.get_registration_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      get_registration_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.iterate" class="md-nav__link">
    <span class="md-ellipsis">
      iterate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.maximization" class="md-nav__link">
    <span class="md-ellipsis">
      maximization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.register" class="md-nav__link">
    <span class="md-ellipsis">
      register
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.transform_point_cloud" class="md-nav__link">
    <span class="md-ellipsis">
      transform_point_cloud
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.update_transform" class="md-nav__link">
    <span class="md-ellipsis">
      update_transform
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.update_variance" class="md-nav__link">
    <span class="md-ellipsis">
      update_variance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    io
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stochastic_registration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    stochastic_registration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utilities
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developers &amp; contributors
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skeleton_refinement.expectation_maximization_registration" class="md-nav__link">
    <span class="md-ellipsis">
      expectation_maximization_registration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration" class="md-nav__link">
    <span class="md-ellipsis">
      ExpectationMaximizationRegistration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ExpectationMaximizationRegistration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.expectation" class="md-nav__link">
    <span class="md-ellipsis">
      expectation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.get_registration_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      get_registration_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.iterate" class="md-nav__link">
    <span class="md-ellipsis">
      iterate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.maximization" class="md-nav__link">
    <span class="md-ellipsis">
      maximization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.register" class="md-nav__link">
    <span class="md-ellipsis">
      register
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.transform_point_cloud" class="md-nav__link">
    <span class="md-ellipsis">
      transform_point_cloud
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.update_transform" class="md-nav__link">
    <span class="md-ellipsis">
      update_transform
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.update_variance" class="md-nav__link">
    <span class="md-ellipsis">
      update_variance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>expectation_maximization_registration</h1>

<div class="doc doc-object doc-module">



<a id="skeleton_refinement.expectation_maximization_registration"></a>
    <div class="doc doc-contents first">

        <p>Point Cloud Registration using Expectation-Maximization</p>
<p>This module implements the Expectation-Maximization algorithm for point cloud registration,
providing a probabilistic approach to align 3D point sets with robust handling of noise and outliers.
This is an abstract base class that should be implemented by specific registration methods.</p>


<details class="key-features" open>
  <summary>Key Features</summary>
  <ul>
<li>Probabilistic point cloud alignment using EM algorithm</li>
<li>Iterative refinement of transformation parameters</li>
<li>Automatic variance estimation for noise handling</li>
<li>Support for rigid and non-rigid transformations</li>
<li>Convergence control through iteration limits and tolerance settings</li>
</ul>
</details>

<details class="note" open>
  <summary>Notes</summary>
  <p>This is a part of the implementation of the stochastic registration algorithm based
on the following paper:
Andriy Myronenko and Xubo Song, "Point set registration: Coherent Point drift", IEEE
Transactions on Pattern Analysis and Machine Intelligence. 32 (2): 2262-2275, 2010.</p>
<p>The library is based on the python implementation of the paper in <code>pycpd</code> package.</p>
</details>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration" class="doc doc-heading">
              <code class="highlight language-python">ExpectationMaximizationRegistration(X, Y, sigma2<span style="color: #666">=</span><span style="color: #008000; font-weight: bold">None</span>, max_iterations<span style="color: #666">=</span>MAX_ITER, tolerance<span style="color: #666">=</span>TOL, w<span style="color: #666">=0</span>, <span style="color: #666">*</span>args, <span style="color: #666">**</span>kwargs)</code>

<a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration" class="headerlink" title="Permanent link">Link</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#object">object</a></code></p>


        <p>Abstract base class for point cloud registration using Expectation-Maximization algorithm.</p>
<p>This class implements the core functionality of the Coherent Point Drift (CPD)
algorithm for point set registration based on Myronenko and Song's paper.
It uses a probabilistic approach where the alignment of two point sets is
treated as a Maximum Likelihood (ML) estimation problem with a Gaussian Mixture
Model (GMM) as the likelihood function.</p>
<p>The class serves as a base for various CPD registration methods (rigid, affine, etc.),
providing common EM framework while requiring specific transformation models to be
implemented in child classes.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.X">X</span></code></td>
            <td>
                  <code>numpy.ndarray, shape ``(N, D)``</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reference point cloud coordinates.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.Y">Y</span></code></td>
            <td>
                  <code>numpy.ndarray, shape ``(M, D)``</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial point cloud coordinates to optimize.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.TY">TY</span></code></td>
            <td>
                  <code>numpy.ndarray, shape ``(M, D)``</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Transformed/registered version of Y after optimization.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.sigma2">sigma2</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Variance of the Gaussian Mixture Model (GMM), updated during registration.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.N">N</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of points in reference cloud <code>X</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.M">M</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of points in source cloud <code>Y</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.D">D</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dimensionality of the point clouds (e.g., 3 for 3D point clouds).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.tolerance">tolerance</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Convergence criterion threshold.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.w">w</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weight of the uniform distribution component for outlier handling.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.max_iterations">max_iterations</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of iterations for the algorithm.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.iteration">iteration</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current iteration number during registration process.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.err">err</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current registration error/distance between point sets.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.P">P</span></code></td>
            <td>
                  <code>numpy.ndarray, shape ``(M, N)``</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Posterior probability matrix of point correspondences.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.Pt1">Pt1</span></code></td>
            <td>
                  <code>numpy.ndarray, shape ``(N,)``</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column-wise sum of posterior probability matrix.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.P1">P1</span></code></td>
            <td>
                  <code>numpy.ndarray, shape ``(M,)``</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Row-wise sum of posterior probability matrix.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.Np">Np</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sum of all elements in the posterior probability matrix.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.q">q</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Negative log-likelihood of the current estimate.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>This is an abstract base class. Child classes must implement:
- <code>update_transform()</code>: Update transformation parameters
- <code>transform_point_cloud()</code>: Apply transformation to point cloud
- <code>update_variance()</code>: Update GMM variance
- <code>get_registration_parameters()</code>: Return registration parameters</p>
</details>

<details class="references" open>
  <summary>References</summary>
  <p>Andriy Myronenko and Xubo Song, "Point set registration: Coherent Point drift",
IEEE Transactions on Pattern Analysis and Machine Intelligence. 32 (2): 2262-2275, 2010.</p>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <p>skeleton_refinement.utilities.initialize_sigma2 : Function to initialize the variance parameter</p>
</details>
        <p>Initialize the Expectation-Maximization registration algorithm.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code>numpy.ndarray, shape ``(N, D)``</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reference point cloud (target) of shape (n_points, dimensions).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Y</code>
            </td>
            <td>
                  <code>numpy.ndarray, shape ``(M, D)``</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Point cloud to be aligned (source) of shape (n_points, dimensions).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sigma2</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a> or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial variance of the Gaussian Mixture Model (GMM).
If <code>None</code>, it will be estimated from data.
Default is <code>None</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_iterations</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of EM iterations. Default is <code>100</code>.</p>
              </div>
            </td>
            <td>
                  <code><span title="skeleton_refinement.expectation_maximization_registration.MAX_ITER">MAX_ITER</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tolerance</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Convergence threshold for stopping iterations.
Algorithm stops when change in error falls below this value.
Default is <code>0.0001</code>.</p>
              </div>
            </td>
            <td>
                  <code><span title="skeleton_refinement.expectation_maximization_registration.TOL">TOL</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>w</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weight of the uniform distribution component (0 &lt;= w &lt; 1).
Used to account for outliers and noise.
A value of <code>0</code> means no outlier handling.
Default is <code>0</code>.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>X</code> or <code>Y</code> are not 2D numpy arrays, or if their dimensions don't match.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>skeleton_refinement/expectation_maximization_registration.py</code></summary>
                    <div class="language-python highlight" style="background: #f8f8f8"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">104</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">105</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">106</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">107</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">108</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">109</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">110</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">111</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">112</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">113</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">114</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">115</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">116</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">117</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">118</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">119</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">120</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">121</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">122</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">123</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">124</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">125</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">126</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">127</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">128</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">129</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">130</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">131</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">132</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">133</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">134</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">135</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">136</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">137</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">138</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">139</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">140</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">141</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">142</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">143</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">144</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">145</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">146</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">147</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">148</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">149</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">150</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">151</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">152</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">153</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">154</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">155</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">156</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span><span style="color: #BBB"> </span><span style="color: #00F">__init__</span>(<span style="color: #008000">self</span>, X, Y, sigma2<span style="color: #666">=</span><span style="color: #008000; font-weight: bold">None</span>, max_iterations<span style="color: #666">=</span>MAX_ITER, tolerance<span style="color: #666">=</span>TOL, w<span style="color: #666">=0</span>, <span style="color: #666">*</span>args, <span style="color: #666">**</span>kwargs):
<span style="color: #BBB">    </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Initialize the Expectation-Maximization registration algorithm.</span>

<span style="color: #BA2121; font-style: italic">    Parameters</span>
<span style="color: #BA2121; font-style: italic">    ----------</span>
<span style="color: #BA2121; font-style: italic">    X : numpy.ndarray, shape ``(N, D)``</span>
<span style="color: #BA2121; font-style: italic">        Reference point cloud (target) of shape (n_points, dimensions).</span>
<span style="color: #BA2121; font-style: italic">    Y : numpy.ndarray, shape ``(M, D)``</span>
<span style="color: #BA2121; font-style: italic">        Point cloud to be aligned (source) of shape (n_points, dimensions).</span>
<span style="color: #BA2121; font-style: italic">    sigma2 : float or None, optional</span>
<span style="color: #BA2121; font-style: italic">        Initial variance of the Gaussian Mixture Model (GMM).</span>
<span style="color: #BA2121; font-style: italic">        If ``None``, it will be estimated from data.</span>
<span style="color: #BA2121; font-style: italic">        Default is ``None``.</span>
<span style="color: #BA2121; font-style: italic">    max_iterations : int, optional</span>
<span style="color: #BA2121; font-style: italic">        Maximum number of EM iterations. Default is ``100``.</span>
<span style="color: #BA2121; font-style: italic">    tolerance : float, optional</span>
<span style="color: #BA2121; font-style: italic">        Convergence threshold for stopping iterations.</span>
<span style="color: #BA2121; font-style: italic">        Algorithm stops when change in error falls below this value.</span>
<span style="color: #BA2121; font-style: italic">        Default is ``0.0001``.</span>
<span style="color: #BA2121; font-style: italic">    w : float, optional</span>
<span style="color: #BA2121; font-style: italic">        Weight of the uniform distribution component (0 &lt;= w &lt; 1).</span>
<span style="color: #BA2121; font-style: italic">        Used to account for outliers and noise.</span>
<span style="color: #BA2121; font-style: italic">        A value of ``0`` means no outlier handling.</span>
<span style="color: #BA2121; font-style: italic">        Default is ``0``.</span>

<span style="color: #BA2121; font-style: italic">    Raises</span>
<span style="color: #BA2121; font-style: italic">    ------</span>
<span style="color: #BA2121; font-style: italic">    ValueError</span>
<span style="color: #BA2121; font-style: italic">        If `X` or `Y` are not 2D numpy arrays, or if their dimensions don&#39;t match.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #A2F; font-weight: bold">not</span> <span style="color: #008000">isinstance</span>(X, np<span style="color: #666">.</span>ndarray) <span style="color: #A2F; font-weight: bold">or</span> X<span style="color: #666">.</span>ndim <span style="color: #666">!=</span> <span style="color: #666">2</span>:
        <span style="color: #008000; font-weight: bold">raise</span> <span style="color: #CB3F38; font-weight: bold">ValueError</span>(<span style="color: #BA2121">&quot;The target point cloud (X) must be at a 2D numpy array.&quot;</span>)
    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #A2F; font-weight: bold">not</span> <span style="color: #008000">isinstance</span>(Y, np<span style="color: #666">.</span>ndarray) <span style="color: #A2F; font-weight: bold">or</span> Y<span style="color: #666">.</span>ndim <span style="color: #666">!=</span> <span style="color: #666">2</span>:
        <span style="color: #008000; font-weight: bold">raise</span> <span style="color: #CB3F38; font-weight: bold">ValueError</span>(<span style="color: #BA2121">&quot;The source point cloud (Y) must be a 2D numpy array.&quot;</span>)
    <span style="color: #008000; font-weight: bold">if</span> X<span style="color: #666">.</span>shape[<span style="color: #666">1</span>] <span style="color: #666">!=</span> Y<span style="color: #666">.</span>shape[<span style="color: #666">1</span>]:
        <span style="color: #008000; font-weight: bold">raise</span> <span style="color: #CB3F38; font-weight: bold">ValueError</span>(<span style="color: #BA2121">&quot;Both point clouds need to have the same number of dimensions.&quot;</span>)

    <span style="color: #008000">self</span><span style="color: #666">.</span>X <span style="color: #666">=</span> X
    <span style="color: #008000">self</span><span style="color: #666">.</span>Y <span style="color: #666">=</span> Y
    <span style="color: #008000">self</span><span style="color: #666">.</span>sigma2 <span style="color: #666">=</span> sigma2
    (<span style="color: #008000">self</span><span style="color: #666">.</span>N, <span style="color: #008000">self</span><span style="color: #666">.</span>D) <span style="color: #666">=</span> <span style="color: #008000">self</span><span style="color: #666">.</span>X<span style="color: #666">.</span>shape
    (<span style="color: #008000">self</span><span style="color: #666">.</span>M, _) <span style="color: #666">=</span> <span style="color: #008000">self</span><span style="color: #666">.</span>Y<span style="color: #666">.</span>shape
    <span style="color: #008000">self</span><span style="color: #666">.</span>tolerance <span style="color: #666">=</span> tolerance
    <span style="color: #008000">self</span><span style="color: #666">.</span>w <span style="color: #666">=</span> w
    <span style="color: #008000">self</span><span style="color: #666">.</span>max_iterations <span style="color: #666">=</span> max_iterations
    <span style="color: #008000">self</span><span style="color: #666">.</span>iteration <span style="color: #666">=</span> <span style="color: #666">0</span>
    <span style="color: #008000">self</span><span style="color: #666">.</span>err <span style="color: #666">=</span> <span style="color: #008000">self</span><span style="color: #666">.</span>tolerance <span style="color: #666">+</span> <span style="color: #666">1</span>
    <span style="color: #008000">self</span><span style="color: #666">.</span>P <span style="color: #666">=</span> np<span style="color: #666">.</span>zeros((<span style="color: #008000">self</span><span style="color: #666">.</span>M, <span style="color: #008000">self</span><span style="color: #666">.</span>N))
    <span style="color: #008000">self</span><span style="color: #666">.</span>Pt1 <span style="color: #666">=</span> np<span style="color: #666">.</span>zeros((<span style="color: #008000">self</span><span style="color: #666">.</span>N,))
    <span style="color: #008000">self</span><span style="color: #666">.</span>P1 <span style="color: #666">=</span> np<span style="color: #666">.</span>zeros((<span style="color: #008000">self</span><span style="color: #666">.</span>M,))
    <span style="color: #008000">self</span><span style="color: #666">.</span>Np <span style="color: #666">=</span> <span style="color: #666">0</span>

    <span style="color: #008000">self</span><span style="color: #666">.</span>TY <span style="color: #666">=</span> <span style="color: #008000; font-weight: bold">None</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.expectation" class="doc doc-heading">
            <code class="highlight language-python">expectation()</code>

<a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.expectation" class="headerlink" title="Permanent link">Link</a></h3>


    <div class="doc doc-contents ">

        <p>Perform the Expectation step of the EM algorithm.</p>
<p>The expectation step estimates the posterior probability (P) that each
point in the source set corresponds to each point in the reference set,
based on the current transformation and GMM variance.</p>
<p>This step also handles outlier detection based on the uniform distribution
weight parameter w.</p>


<details class="note" open>
  <summary>Notes</summary>
  <p>Updates the following attributes:
- P: Posterior probability matrix of point correspondences
- Pt1: Column-wise sum of P
- P1: Row-wise sum of P
- Np: Sum of all elements in P</p>
</details>

            <details class="quote">
              <summary>Source code in <code>skeleton_refinement/expectation_maximization_registration.py</code></summary>
              <div class="language-python highlight" style="background: #f8f8f8"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">280</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">281</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">282</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">283</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">284</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">285</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">286</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">287</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">288</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">289</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">290</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">291</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">292</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">293</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">294</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">295</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">296</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">297</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">298</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">299</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">300</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">301</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">302</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">303</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">304</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">305</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">306</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">307</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">308</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">309</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">310</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">311</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">312</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">313</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">314</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">315</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">316</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">317</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">318</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">319</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">320</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">321</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">322</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">323</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">324</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">325</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">326</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">327</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">328</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">329</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">330</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">331</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">332</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span><span style="color: #BBB"> </span><span style="color: #00F">expectation</span>(<span style="color: #008000">self</span>):
<span style="color: #BBB">    </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Perform the Expectation step of the EM algorithm.</span>

<span style="color: #BA2121; font-style: italic">    The expectation step estimates the posterior probability (P) that each</span>
<span style="color: #BA2121; font-style: italic">    point in the source set corresponds to each point in the reference set,</span>
<span style="color: #BA2121; font-style: italic">    based on the current transformation and GMM variance.</span>

<span style="color: #BA2121; font-style: italic">    This step also handles outlier detection based on the uniform distribution</span>
<span style="color: #BA2121; font-style: italic">    weight parameter w.</span>

<span style="color: #BA2121; font-style: italic">    Notes</span>
<span style="color: #BA2121; font-style: italic">    -----</span>
<span style="color: #BA2121; font-style: italic">    Updates the following attributes:</span>
<span style="color: #BA2121; font-style: italic">    - P: Posterior probability matrix of point correspondences</span>
<span style="color: #BA2121; font-style: italic">    - Pt1: Column-wise sum of P</span>
<span style="color: #BA2121; font-style: italic">    - P1: Row-wise sum of P</span>
<span style="color: #BA2121; font-style: italic">    - Np: Sum of all elements in P</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #3D7B7B; font-style: italic"># Initialize posterior probability matrix (M source points  N reference points)</span>
    P <span style="color: #666">=</span> np<span style="color: #666">.</span>zeros((<span style="color: #008000">self</span><span style="color: #666">.</span>M, <span style="color: #008000">self</span><span style="color: #666">.</span>N))

    <span style="color: #3D7B7B; font-style: italic"># Calculate squared Mahalanobis distances between transformed source points and reference points</span>
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #A2F; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666">0</span>, <span style="color: #008000">self</span><span style="color: #666">.</span>M):
        <span style="color: #3D7B7B; font-style: italic"># Calculate differences between current transformed point and all reference points</span>
        diff <span style="color: #666">=</span> <span style="color: #008000">self</span><span style="color: #666">.</span>X <span style="color: #666">-</span> np<span style="color: #666">.</span>tile(<span style="color: #008000">self</span><span style="color: #666">.</span>TY[i, :], (<span style="color: #008000">self</span><span style="color: #666">.</span>N, <span style="color: #666">1</span>))
        <span style="color: #3D7B7B; font-style: italic"># Square the differences</span>
        diff <span style="color: #666">=</span> np<span style="color: #666">.</span>multiply(diff, diff)
        <span style="color: #3D7B7B; font-style: italic"># Sum squared differences across dimensions for each point pair</span>
        P[i, :] <span style="color: #666">=</span> P[i, :] <span style="color: #666">+</span> np<span style="color: #666">.</span>sum(diff, axis<span style="color: #666">=1</span>)

    <span style="color: #3D7B7B; font-style: italic"># Calculate uniform distribution component for outlier handling</span>
    c <span style="color: #666">=</span> (<span style="color: #666">2</span> <span style="color: #666">*</span> np<span style="color: #666">.</span>pi <span style="color: #666">*</span> <span style="color: #008000">self</span><span style="color: #666">.</span>sigma2) <span style="color: #666">**</span> (<span style="color: #008000">self</span><span style="color: #666">.</span>D <span style="color: #666">/</span> <span style="color: #666">2</span>)  <span style="color: #3D7B7B; font-style: italic"># Normalization factor for Gaussian</span>
    c <span style="color: #666">=</span> c <span style="color: #666">*</span> <span style="color: #008000">self</span><span style="color: #666">.</span>w <span style="color: #666">/</span> (<span style="color: #666">1</span> <span style="color: #666">-</span> <span style="color: #008000">self</span><span style="color: #666">.</span>w)  <span style="color: #3D7B7B; font-style: italic"># Scale by outlier ratio</span>
    c <span style="color: #666">=</span> c <span style="color: #666">*</span> <span style="color: #008000">self</span><span style="color: #666">.</span>M <span style="color: #666">/</span> <span style="color: #008000">self</span><span style="color: #666">.</span>N  <span style="color: #3D7B7B; font-style: italic"># Normalize by point cloud sizes</span>

    <span style="color: #3D7B7B; font-style: italic"># Convert distances to probabilities using Gaussian kernel</span>
    P <span style="color: #666">=</span> np<span style="color: #666">.</span>exp(<span style="color: #666">-</span>P <span style="color: #666">/</span> (<span style="color: #666">2</span> <span style="color: #666">*</span> <span style="color: #008000">self</span><span style="color: #666">.</span>sigma2))

    <span style="color: #3D7B7B; font-style: italic"># Calculate denominator for posterior probability normalization</span>
    den <span style="color: #666">=</span> np<span style="color: #666">.</span>sum(P, axis<span style="color: #666">=0</span>)
    den <span style="color: #666">=</span> np<span style="color: #666">.</span>tile(den, (<span style="color: #008000">self</span><span style="color: #666">.</span>M, <span style="color: #666">1</span>))
    <span style="color: #3D7B7B; font-style: italic"># Avoid division by zero</span>
    den[den <span style="color: #666">==</span> <span style="color: #666">0</span>] <span style="color: #666">=</span> np<span style="color: #666">.</span>finfo(<span style="color: #008000">float</span>)<span style="color: #666">.</span>eps
    <span style="color: #3D7B7B; font-style: italic"># Add uniform component for outlier handling</span>
    den <span style="color: #666">+=</span> c

    <span style="color: #3D7B7B; font-style: italic"># Compute normalized posterior probabilities</span>
    <span style="color: #008000">self</span><span style="color: #666">.</span>P <span style="color: #666">=</span> np<span style="color: #666">.</span>divide(P, den)

    <span style="color: #3D7B7B; font-style: italic"># Calculate marginal probabilities and total correspondence strength</span>
    <span style="color: #008000">self</span><span style="color: #666">.</span>Pt1 <span style="color: #666">=</span> np<span style="color: #666">.</span>sum(<span style="color: #008000">self</span><span style="color: #666">.</span>P, axis<span style="color: #666">=0</span>)  <span style="color: #3D7B7B; font-style: italic"># Column-wise sum - probability mass for each reference point</span>
    <span style="color: #008000">self</span><span style="color: #666">.</span>P1 <span style="color: #666">=</span> np<span style="color: #666">.</span>sum(<span style="color: #008000">self</span><span style="color: #666">.</span>P, axis<span style="color: #666">=1</span>)  <span style="color: #3D7B7B; font-style: italic"># Row-wise sum - probability mass for each source point</span>
    <span style="color: #008000">self</span><span style="color: #666">.</span>Np <span style="color: #666">=</span> np<span style="color: #666">.</span>sum(<span style="color: #008000">self</span><span style="color: #666">.</span>P1)  <span style="color: #3D7B7B; font-style: italic"># Total correspondence probability mass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.get_registration_parameters" class="doc doc-heading">
            <code class="highlight language-python">get_registration_parameters()</code>

<a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.get_registration_parameters" class="headerlink" title="Permanent link">Link</a></h3>


    <div class="doc doc-contents ">

        <p>Get the current registration transformation parameters.</p>
<p>This is an abstract method that must be implemented by child classes
to return the specific transformation parameters used in the registration.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary containing the transformation parameters specific to
the registration method.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError">NotImplementedError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If called from the base class without being overridden.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skeleton_refinement/expectation_maximization_registration.py</code></summary>
              <div class="language-python highlight" style="background: #f8f8f8"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">199</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">200</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">201</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">202</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">203</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">204</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">205</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">206</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">207</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">208</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">209</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">210</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">211</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">212</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">213</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">214</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">215</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">216</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span><span style="color: #BBB"> </span><span style="color: #00F">get_registration_parameters</span>(<span style="color: #008000">self</span>):
<span style="color: #BBB">    </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Get the current registration transformation parameters.</span>

<span style="color: #BA2121; font-style: italic">    This is an abstract method that must be implemented by child classes</span>
<span style="color: #BA2121; font-style: italic">    to return the specific transformation parameters used in the registration.</span>

<span style="color: #BA2121; font-style: italic">    Returns</span>
<span style="color: #BA2121; font-style: italic">    -------</span>
<span style="color: #BA2121; font-style: italic">    dict</span>
<span style="color: #BA2121; font-style: italic">        Dictionary containing the transformation parameters specific to</span>
<span style="color: #BA2121; font-style: italic">        the registration method.</span>

<span style="color: #BA2121; font-style: italic">    Raises</span>
<span style="color: #BA2121; font-style: italic">    ------</span>
<span style="color: #BA2121; font-style: italic">    NotImplementedError</span>
<span style="color: #BA2121; font-style: italic">        If called from the base class without being overridden.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">raise</span> <span style="color: #CB3F38; font-weight: bold">NotImplementedError</span>(<span style="color: #BA2121">&quot;Registration parameters should be defined in child classes.&quot;</span>)
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.iterate" class="doc doc-heading">
            <code class="highlight language-python">iterate()</code>

<a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.iterate" class="headerlink" title="Permanent link">Link</a></h3>


    <div class="doc doc-contents ">

        <p>Perform one Expectation-Maximization iteration.</p>
<p>This method runs a single EM iteration consisting of:
1. Expectation step: compute point correspondences
2. Maximization step: update transformation parameters</p>
<p>The iteration counter is incremented after each call.</p>


            <details class="quote">
              <summary>Source code in <code>skeleton_refinement/expectation_maximization_registration.py</code></summary>
              <div class="language-python highlight" style="background: #f8f8f8"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">267</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">268</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">269</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">270</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">271</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">272</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">273</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">274</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">275</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">276</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">277</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">278</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span><span style="color: #BBB"> </span><span style="color: #00F">iterate</span>(<span style="color: #008000">self</span>):
<span style="color: #BBB">    </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Perform one Expectation-Maximization iteration.</span>

<span style="color: #BA2121; font-style: italic">    This method runs a single EM iteration consisting of:</span>
<span style="color: #BA2121; font-style: italic">    1. Expectation step: compute point correspondences</span>
<span style="color: #BA2121; font-style: italic">    2. Maximization step: update transformation parameters</span>

<span style="color: #BA2121; font-style: italic">    The iteration counter is incremented after each call.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000">self</span><span style="color: #666">.</span>expectation()
    <span style="color: #008000">self</span><span style="color: #666">.</span>maximization()
    <span style="color: #008000">self</span><span style="color: #666">.</span>iteration <span style="color: #666">+=</span> <span style="color: #666">1</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.maximization" class="doc doc-heading">
            <code class="highlight language-python">maximization()</code>

<a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.maximization" class="headerlink" title="Permanent link">Link</a></h3>


    <div class="doc doc-contents ">

        <p>Perform the Maximization step of the EM algorithm.</p>
<p>The maximization step updates the transformation parameters and variance
to maximize the probability that the transformed source points were drawn
from the GMM centered at the reference points.</p>
<p>This method calls the abstract methods that should be implemented by child
classes:
1. update_transform()
2. transform_point_cloud()
3. update_variance()</p>


            <details class="quote">
              <summary>Source code in <code>skeleton_refinement/expectation_maximization_registration.py</code></summary>
              <div class="language-python highlight" style="background: #f8f8f8"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">334</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">335</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">336</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">337</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">338</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">339</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">340</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">341</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">342</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">343</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">344</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">345</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">346</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">347</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">348</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">349</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span><span style="color: #BBB"> </span><span style="color: #00F">maximization</span>(<span style="color: #008000">self</span>):
<span style="color: #BBB">    </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Perform the Maximization step of the EM algorithm.</span>

<span style="color: #BA2121; font-style: italic">    The maximization step updates the transformation parameters and variance</span>
<span style="color: #BA2121; font-style: italic">    to maximize the probability that the transformed source points were drawn</span>
<span style="color: #BA2121; font-style: italic">    from the GMM centered at the reference points.</span>

<span style="color: #BA2121; font-style: italic">    This method calls the abstract methods that should be implemented by child</span>
<span style="color: #BA2121; font-style: italic">    classes:</span>
<span style="color: #BA2121; font-style: italic">    1. update_transform()</span>
<span style="color: #BA2121; font-style: italic">    2. transform_point_cloud()</span>
<span style="color: #BA2121; font-style: italic">    3. update_variance()</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000">self</span><span style="color: #666">.</span>update_transform()
    <span style="color: #008000">self</span><span style="color: #666">.</span>transform_point_cloud()
    <span style="color: #008000">self</span><span style="color: #666">.</span>update_variance()
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.register" class="doc doc-heading">
            <code class="highlight language-python">register(callback<span style="color: #666">=</span><span style="color: #008000; font-weight: bold">lambda</span> <span style="color: #666">**</span>kwargs: <span style="color: #008000; font-weight: bold">None</span>)</code>

<a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.register" class="headerlink" title="Permanent link">Link</a></h3>


    <div class="doc doc-contents ">

        <p>Perform the point set registration.</p>
<p>This method runs the EM algorithm to align the source point cloud (Y)
to the reference point cloud (X). The algorithm iteratively estimates
point correspondences and updates the transformation parameters until
convergence or maximum iterations are reached.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>callback</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#callable">callable</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to call after each iteration with registration state information.
The function should accept keyword arguments: iteration, error, X, Y.
Default is a no-op function.</p>
              </div>
            </td>
            <td>
                  <code>lambda **kwargs: None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="numpy.ndarray" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray">ndarray</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The transformed point cloud (TY).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Registration parameters specific to the registration method.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>The registration is considered converged when the change in error between
iterations falls below the tolerance threshold or the maximum number of
iterations is reached.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>skeleton_refinement/expectation_maximization_registration.py</code></summary>
              <div class="language-python highlight" style="background: #f8f8f8"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">218</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">219</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">220</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">221</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">222</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">223</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">224</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">225</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">226</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">227</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">228</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">229</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">230</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">231</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">232</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">233</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">234</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">235</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">236</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">237</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">238</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">239</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">240</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">241</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">242</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">243</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">244</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">245</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">246</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">247</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">248</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">249</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">250</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">251</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">252</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">253</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">254</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">255</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">256</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">257</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">258</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">259</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">260</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">261</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">262</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">263</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">264</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">265</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span><span style="color: #BBB"> </span><span style="color: #00F">register</span>(<span style="color: #008000">self</span>, callback<span style="color: #666">=</span><span style="color: #008000; font-weight: bold">lambda</span> <span style="color: #666">**</span>kwargs: <span style="color: #008000; font-weight: bold">None</span>):
<span style="color: #BBB">    </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Perform the point set registration.</span>

<span style="color: #BA2121; font-style: italic">    This method runs the EM algorithm to align the source point cloud (Y)</span>
<span style="color: #BA2121; font-style: italic">    to the reference point cloud (X). The algorithm iteratively estimates</span>
<span style="color: #BA2121; font-style: italic">    point correspondences and updates the transformation parameters until</span>
<span style="color: #BA2121; font-style: italic">    convergence or maximum iterations are reached.</span>

<span style="color: #BA2121; font-style: italic">    Parameters</span>
<span style="color: #BA2121; font-style: italic">    ----------</span>
<span style="color: #BA2121; font-style: italic">    callback : callable, optional</span>
<span style="color: #BA2121; font-style: italic">        Function to call after each iteration with registration state information.</span>
<span style="color: #BA2121; font-style: italic">        The function should accept keyword arguments: iteration, error, X, Y.</span>
<span style="color: #BA2121; font-style: italic">        Default is a no-op function.</span>

<span style="color: #BA2121; font-style: italic">    Returns</span>
<span style="color: #BA2121; font-style: italic">    -------</span>
<span style="color: #BA2121; font-style: italic">    numpy.ndarray</span>
<span style="color: #BA2121; font-style: italic">        The transformed point cloud (TY).</span>
<span style="color: #BA2121; font-style: italic">    dict</span>
<span style="color: #BA2121; font-style: italic">        Registration parameters specific to the registration method.</span>

<span style="color: #BA2121; font-style: italic">    Notes</span>
<span style="color: #BA2121; font-style: italic">    -----</span>
<span style="color: #BA2121; font-style: italic">    The registration is considered converged when the change in error between</span>
<span style="color: #BA2121; font-style: italic">    iterations falls below the tolerance threshold or the maximum number of</span>
<span style="color: #BA2121; font-style: italic">    iterations is reached.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #3D7B7B; font-style: italic"># Initialize by transforming points according to current parameters</span>
    <span style="color: #008000">self</span><span style="color: #666">.</span>transform_point_cloud()

    <span style="color: #3D7B7B; font-style: italic"># If variance is not provided, calculate initial variance based on point clouds</span>
    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">self</span><span style="color: #666">.</span>sigma2 <span style="color: #A2F; font-weight: bold">is</span> <span style="color: #008000; font-weight: bold">None</span>:
        <span style="color: #008000">self</span><span style="color: #666">.</span>sigma2 <span style="color: #666">=</span> initialize_sigma2(<span style="color: #008000">self</span><span style="color: #666">.</span>X, <span style="color: #008000">self</span><span style="color: #666">.</span>TY)

    <span style="color: #3D7B7B; font-style: italic"># Initialize negative log-likelihood (q) based on current error and variance</span>
    <span style="color: #008000">self</span><span style="color: #666">.</span>q <span style="color: #666">=</span> <span style="color: #666">-</span><span style="color: #008000">self</span><span style="color: #666">.</span>err <span style="color: #666">-</span> <span style="color: #008000">self</span><span style="color: #666">.</span>N <span style="color: #666">*</span> <span style="color: #008000">self</span><span style="color: #666">.</span>D <span style="color: #666">/</span> <span style="color: #666">2</span> <span style="color: #666">*</span> np<span style="color: #666">.</span>log(<span style="color: #008000">self</span><span style="color: #666">.</span>sigma2)

    <span style="color: #3D7B7B; font-style: italic"># Main EM loop - continue until convergence or max iterations</span>
    <span style="color: #008000; font-weight: bold">while</span> <span style="color: #008000">self</span><span style="color: #666">.</span>iteration <span style="color: #666">&lt;</span> <span style="color: #008000">self</span><span style="color: #666">.</span>max_iterations <span style="color: #A2F; font-weight: bold">and</span> <span style="color: #008000">self</span><span style="color: #666">.</span>err <span style="color: #666">&gt;</span> <span style="color: #008000">self</span><span style="color: #666">.</span>tolerance:
        <span style="color: #3D7B7B; font-style: italic"># Run one iteration of Expectation-Maximization algorithm</span>
        <span style="color: #008000">self</span><span style="color: #666">.</span>iterate()
        <span style="color: #3D7B7B; font-style: italic"># If callback is provided, execute it with current registration state</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">callable</span>(callback):
            kwargs <span style="color: #666">=</span> {<span style="color: #BA2121">&#39;iteration&#39;</span>: <span style="color: #008000">self</span><span style="color: #666">.</span>iteration, <span style="color: #BA2121">&#39;error&#39;</span>: <span style="color: #008000">self</span><span style="color: #666">.</span>err, <span style="color: #BA2121">&#39;X&#39;</span>: <span style="color: #008000">self</span><span style="color: #666">.</span>X, <span style="color: #BA2121">&#39;Y&#39;</span>: <span style="color: #008000">self</span><span style="color: #666">.</span>TY}
            callback(<span style="color: #666">**</span>kwargs)

    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666">.</span>TY, <span style="color: #008000">self</span><span style="color: #666">.</span>get_registration_parameters()
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.transform_point_cloud" class="doc doc-heading">
            <code class="highlight language-python">transform_point_cloud()</code>

<a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.transform_point_cloud" class="headerlink" title="Permanent link">Link</a></h3>


    <div class="doc doc-contents ">

        <p>Apply the current transformation to the source point cloud.</p>
<p>This is an abstract method that must be implemented by child classes
to apply the specific transformation to the point cloud Y and update TY.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError">NotImplementedError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If called from the base class without being overridden.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skeleton_refinement/expectation_maximization_registration.py</code></summary>
              <div class="language-python highlight" style="background: #f8f8f8"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">172</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">173</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">174</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">175</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">176</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">177</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">178</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">179</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">180</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">181</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">182</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">183</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span><span style="color: #BBB"> </span><span style="color: #00F">transform_point_cloud</span>(<span style="color: #008000">self</span>):
<span style="color: #BBB">    </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Apply the current transformation to the source point cloud.</span>

<span style="color: #BA2121; font-style: italic">    This is an abstract method that must be implemented by child classes</span>
<span style="color: #BA2121; font-style: italic">    to apply the specific transformation to the point cloud Y and update TY.</span>

<span style="color: #BA2121; font-style: italic">    Raises</span>
<span style="color: #BA2121; font-style: italic">    ------</span>
<span style="color: #BA2121; font-style: italic">    NotImplementedError</span>
<span style="color: #BA2121; font-style: italic">        If called from the base class without being overridden.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">raise</span> <span style="color: #CB3F38; font-weight: bold">NotImplementedError</span>(<span style="color: #BA2121">&quot;This method should be defined in child classes.&quot;</span>)
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.update_transform" class="doc doc-heading">
            <code class="highlight language-python">update_transform()</code>

<a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.update_transform" class="headerlink" title="Permanent link">Link</a></h3>


    <div class="doc doc-contents ">

        <p>Update transformation parameters based on the current point correspondence.</p>
<p>This is an abstract method that must be implemented by child classes
to update the specific transformation parameters (e.g., rotation matrix,
scaling factor, etc.) based on the current state of the registration.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError">NotImplementedError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If called from the base class without being overridden.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skeleton_refinement/expectation_maximization_registration.py</code></summary>
              <div class="language-python highlight" style="background: #f8f8f8"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">158</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">159</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">160</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">161</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">162</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">163</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">164</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">165</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">166</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">167</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">168</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">169</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">170</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span><span style="color: #BBB"> </span><span style="color: #00F">update_transform</span>(<span style="color: #008000">self</span>):
<span style="color: #BBB">    </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Update transformation parameters based on the current point correspondence.</span>

<span style="color: #BA2121; font-style: italic">    This is an abstract method that must be implemented by child classes</span>
<span style="color: #BA2121; font-style: italic">    to update the specific transformation parameters (e.g., rotation matrix,</span>
<span style="color: #BA2121; font-style: italic">    scaling factor, etc.) based on the current state of the registration.</span>

<span style="color: #BA2121; font-style: italic">    Raises</span>
<span style="color: #BA2121; font-style: italic">    ------</span>
<span style="color: #BA2121; font-style: italic">    NotImplementedError</span>
<span style="color: #BA2121; font-style: italic">        If called from the base class without being overridden.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">raise</span> <span style="color: #CB3F38; font-weight: bold">NotImplementedError</span>(<span style="color: #BA2121">&quot;This method should be defined in child classes.&quot;</span>)
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.update_variance" class="doc doc-heading">
            <code class="highlight language-python">update_variance()</code>

<a href="#skeleton_refinement.expectation_maximization_registration.ExpectationMaximizationRegistration.update_variance" class="headerlink" title="Permanent link">Link</a></h3>


    <div class="doc doc-contents ">

        <p>Update the variance of the GMM model (sigma2).</p>
<p>This is an abstract method that must be implemented by child classes
to update the variance parameter based on the current state of the
registration process.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError">NotImplementedError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If called from the base class without being overridden.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>skeleton_refinement/expectation_maximization_registration.py</code></summary>
              <div class="language-python highlight" style="background: #f8f8f8"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">185</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">186</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">187</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">188</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">189</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">190</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">191</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">192</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">193</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">194</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">195</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">196</span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;">197</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #008000; font-weight: bold">def</span><span style="color: #BBB"> </span><span style="color: #00F">update_variance</span>(<span style="color: #008000">self</span>):
<span style="color: #BBB">    </span><span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Update the variance of the GMM model (sigma2).</span>

<span style="color: #BA2121; font-style: italic">    This is an abstract method that must be implemented by child classes</span>
<span style="color: #BA2121; font-style: italic">    to update the variance parameter based on the current state of the</span>
<span style="color: #BA2121; font-style: italic">    registration process.</span>

<span style="color: #BA2121; font-style: italic">    Raises</span>
<span style="color: #BA2121; font-style: italic">    ------</span>
<span style="color: #BA2121; font-style: italic">    NotImplementedError</span>
<span style="color: #BA2121; font-style: italic">        If called from the base class without being overridden.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">raise</span> <span style="color: #CB3F38; font-weight: bold">NotImplementedError</span>(<span style="color: #BA2121">&quot;This method should be defined in child classes.&quot;</span>)
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      The ROMI project has received funding from the European Communitys H2020 Programme under Grant Agreement No. 773875.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/ROMI_EU_PROJECT" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.facebook.com/ROMIEUProject" target="_blank" rel="noopener" title="www.facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/romi/skeleton_refinement" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../../assets/_markdown_exec_pyodide.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="https://buttons.github.io/buttons.js"></script>
      
    
  </body>
</html>